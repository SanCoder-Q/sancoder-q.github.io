---
layout: post
title: SICP Exercise Results
---

<div id="outline-container-orgheadline21" class="outline-2">
<h2 id="orgheadline21">1. Building Abstractions with Procedures</h2>
<div class="outline-text-2" id="text-orgheadline21">
</div><div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20">1.1 The Elements of Programming</h3>
<div class="outline-text-3" id="text-orgheadline20">
</div><div id="outline-container-orgheadline1" class="outline-4">
<h4 id="orgheadline1">Exercise 1.1</h4>
<div class="outline-text-4" id="text-orgheadline1">
<div class="org-src-container">

<pre class="src src-scheme">(list 10
      (+ 5 3 4)
      (- 9 1)
      (/ 6 2)
      (+ (* 2 4) (- 4 6))
      )
</pre>
</div>

<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> <span style="color: #f99157;">a</span> 3)
(<span style="color: #99cc99;">define</span> <span style="color: #f99157;">b</span> (+ a 1))
(list (+ a b (* a b))
      (= a b)
      (<span style="color: #99cc99;">if</span> (<span style="color: #99cc99;">and</span> (&gt; b a) (&lt; b (* a b)))
          b
          a)
      (<span style="color: #99cc99;">cond</span> ((= a 4) 6)
            ((= b 4) (+ 6 7 a))
            (<span style="color: #99cc99;">else</span> 25))
      (+ 2 (<span style="color: #99cc99;">if</span> (&gt; b a) b a))
      (* (<span style="color: #99cc99;">cond</span> ((&gt; a b) a)
               ((&lt; a b) b)
               (<span style="color: #99cc99;">else</span> -1))
         (+ a 1)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline2" class="outline-4">
<h4 id="orgheadline2">Exercise 1.2</h4>
<div class="outline-text-4" id="text-orgheadline2">
<div class="org-src-container">

<pre class="src src-scheme">(/ (+ 5 4 (- 2 (- 3 (+ 6 (/ 4 5)))))
   (* 3 (- 6 2) (- 2 7)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-4">
<h4 id="orgheadline3">Exercise 1.3</h4>
<div class="outline-text-4" id="text-orgheadline3">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">func</span> a b c)
  (<span style="color: #99cc99;">if</span> (&gt; a b)
      (<span style="color: #99cc99;">if</span> (&gt; b c)
          (+ a b)
          (+ a c))
      (<span style="color: #99cc99;">if</span> (&gt; a c)
          (+ a b)
          (+ b c))))
(func 4 2 3)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline4" class="outline-4">
<h4 id="orgheadline4">Exercise 1.4</h4>
</div>
<div id="outline-container-orgheadline5" class="outline-4">
<h4 id="orgheadline5">Exercise 1.5</h4>
<div class="outline-text-4" id="text-orgheadline5">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">q</span>) (q))
</pre>
</div>
<p>
This line means to define a <b>non-parameter recursive function</b>. So once it be evaluated, the complier will go into a endless loop.<br  />
The difference between <code>normal order</code> and <code>applicative order</code> is the first one will not eval anything before all the expression is expanded.<br  />
So in this exercise, if the complier is using the <code>applicative order</code> to interpreter the code, it will crash.<br  />
Another interest thing is <code>if</code> syntax. It's a high level structor with a specific process which means there is only one of the expression will be evaluated whatever the predicate is. Hence, if the coplier is using the <code>normal order</code>, the result will be 0.<br  />
</p>
</div>
</div>
<div id="outline-container-orgheadline6" class="outline-4">
<h4 id="orgheadline6">Exercise 1.6</h4>
<div class="outline-text-4" id="text-orgheadline6">
<p>
Same reason as the <code>Exercise 1.6</code>, the <code>new-if</code> is using the <code>cond</code> syntax, and it will evaluate the predicate and the follow expression at the same time. So it should not be used to stop a recursive process.<br  />
</p>
</div>
</div>
<div id="outline-container-orgheadline7" class="outline-4">
<h4 id="orgheadline7">Exercise 1.7</h4>
<div class="outline-text-4" id="text-orgheadline7">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">improve</span> guess x)
  (/ (+ guess (/ x guess)) 2))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">abs</span> x)
  (<span style="color: #99cc99;">if</span> (&lt; x 0)
      (- x)
      x))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">good-enough?</span> guess last-guess)
  (<span style="color: #99cc99;">if</span> (&lt; (abs (- (/ guess last-guess) 1)) 0.01)
      #t
      #f))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">sqrt-iter</span> guess last-guess x)
  (<span style="color: #99cc99;">if</span> (= x 0)
      0
      (<span style="color: #99cc99;">if</span> (good-enough? guess last-guess)
          guess
          (sqrt-iter (improve guess x) guess x))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">my-sqrt</span> x)
  (sqrt-iter 1.0 x x))

(list
 (my-sqrt 10000)
 (my-sqrt 100)
 (my-sqrt 0.0001)
 (my-sqrt 0))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-4">
<h4 id="orgheadline8">Exercise 1.8</h4>
<div class="outline-text-4" id="text-orgheadline8">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">improve</span> guess x)
  (/ (+ (/ x (* guess guess)) (* 2 guess)) 3))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">abs</span> x)
  (<span style="color: #99cc99;">if</span> (&lt; x 0)
      (- x)
      x))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">good-enough?</span> guess last-guess)
  (<span style="color: #99cc99;">if</span> (&lt; (abs (- (/ guess last-guess) 1)) 0.01)
      #t
      #f))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">cube-iter</span> guess last-guess x)
  (<span style="color: #99cc99;">if</span> (= x 0)
      0
      (<span style="color: #99cc99;">if</span> (good-enough? guess last-guess)
          guess
          (cube-iter (improve guess x) guess x))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">my-cube</span> x)
  (cube-iter 1.0 x x))

(list
 (my-cube 1000000)
 (my-cube 27)
 (my-cube 0.001)
 (my-cube 0))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline9" class="outline-4">
<h4 id="orgheadline9">Exercise 1.9</h4>
<div class="outline-text-4" id="text-orgheadline9">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">inc</span> x)
  (+ x 1))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">dec</span> x)
  (- x 1))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">mplus1</span> a b)
  (<span style="color: #99cc99;">if</span> (= a 0)
      b
      (inc (mplus1 (dec a) b))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">mplus2</span> a b)
  (<span style="color: #99cc99;">if</span> (= a 0)
      b
      (mplus2 (dec a) (inc b))))

(list (list (mplus1 4 5)
            (inc (mplus1 3 5))
            (inc (inc (mplus1 2 5)))
            (inc (inc (inc (mplus1 1 5))))
            (inc (inc (inc (inc (mplus1 0 5)))))
            (inc (inc (inc (inc 5))))
            (inc (inc (inc 6)))
            (inc (inc 7))
            (inc 8)
            9)

      (list (mplus2 4 5)
            (mplus2 3 6)
            (mplus2 2 7)
            (mplus2 1 8)
            (mplus2 0 9)
            9))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline10" class="outline-4">
<h4 id="orgheadline10">Exercise 1.10</h4>
<div class="outline-text-4" id="text-orgheadline10">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">A</span> x y)
  (<span style="color: #99cc99;">cond</span> ((= y 0) 0)
        ((= x 0) (* 2 y))
        ((= y 1) 2)
        (<span style="color: #99cc99;">else</span> (A (- x 1)
                 (A x (- y 1))))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">f</span> n) (A 0 n))  <span style="color: #999999; font-style: italic;">;;</span><span style="color: #999999; font-style: italic;">2y</span>

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">g</span> n) (A 1 n))  <span style="color: #999999; font-style: italic;">;;</span><span style="color: #999999; font-style: italic;">2^n</span>

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">h</span> n) (A 2 n))  <span style="color: #999999; font-style: italic;">;;</span><span style="color: #999999; font-style: italic;">2^(2^n)</span>

(list (A 1 10)
      (A 2 4)
      (A 3 3))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline11" class="outline-4">
<h4 id="orgheadline11">Exercise 1.11</h4>
<div class="outline-text-4" id="text-orgheadline11">
<ul class="org-ul">
<li>Tree Recursion<br  /></li>
</ul>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">f</span> n)
  (<span style="color: #99cc99;">if</span> (&lt; n 3)
      n
      (+ (f (- n 1))
         (* 2 (f (- n 2)))
         (* 3 (f (- n 3))))))

(list (f 2)
      (f 3)
      (f 4)
      (f 5)
      (f 6)
      (f 7)
      (f 8)
      (f 9))
</pre>
</div>

<ul class="org-ul">
<li>Iteration Recursion<br  /></li>
</ul>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">iter-f</span> c lc llc n)
  (<span style="color: #99cc99;">cond</span> ((&lt; n 2) n)
        ((= n 2) c)
        (<span style="color: #99cc99;">else</span> (iter-f (+ c (* 2 lc) (* 3 llc))
                      c
                      lc
                      (- n 1)))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">f</span> n)
  (iter-f 2 1 0 n))

(list (f 2)
      (f 3)
      (f 4)
      (f 5)
      (f 6)
      (f 7)
      (f 8)
      (f 9))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline12" class="outline-4">
<h4 id="orgheadline12">Exercise 1.12</h4>
<div class="outline-text-4" id="text-orgheadline12">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">pp</span> n i)
  (<span style="color: #99cc99;">if</span> (<span style="color: #99cc99;">or</span> (= n i) (= i 1))
      1
      (+ (pp (- n 1) (- i 1))
         (pp (- n 1) i))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">iter-p</span> l i n)
  (<span style="color: #99cc99;">if</span> (&lt; i n)
      (iter-p (cons (pp n (+ i 1)) l)
              (+ i 1)
              n)
      l))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">p</span> n)
  (iter-p (list (pp n 1))
          1
          n))

(list (p 2)
      (p 3)
      (p 4)
      (p 5)
      (p 6))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline13" class="outline-4">
<h4 id="orgheadline13">Exercise 1.13 1.14 1.15</h4>
<div class="outline-text-4" id="text-orgheadline13">
<p>
What the hell!<br  />
</p>
</div>
</div>
<div id="outline-container-orgheadline14" class="outline-4">
<h4 id="orgheadline14">Exercise 1.16</h4>
<div class="outline-text-4" id="text-orgheadline14">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">even?</span> n)
  (= (remainder n 2) 0))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">square</span> n)
  (* n n))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">fast-expt-iter</span> a b n)
  (<span style="color: #99cc99;">cond</span> ((= n 0) a)
        ((even? n) (fast-expt-iter a (square b) (/ n 2)))
        (<span style="color: #99cc99;">else</span> (fast-expt-iter (* a b) b (- n 1)))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">fast-expt</span> b n)
  (fast-expt-iter 1 b n))

(list (fast-expt 2 5)
      (fast-expt 2 8)
      (fast-expt 2 10)
      (fast-expt 2 11))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline15" class="outline-4">
<h4 id="orgheadline15">Exercise 1.17 1.18</h4>
<div class="outline-text-4" id="text-orgheadline15">
<p>
Using commutation law<br  />
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">even?</span> n)
  (= (remainder n 2) 0))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">double</span> n)
  (+ n n))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">halve</span> n)
  (/ n 2))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">fast-mult-iter</span> a b n)
  (<span style="color: #99cc99;">cond</span> ((= n 0) a)
        ((even? n) (fast-mult-iter a (double b) (halve n)))
        (<span style="color: #99cc99;">else</span> (fast-mult-iter (+ a b) b (- n 1)))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">fast-mult</span> b n)
  (<span style="color: #99cc99;">if</span> (&lt; b n)
      (fast-mult-iter 0 n b)
      (fast-mult-iter 0 b n)))

(list (fast-mult 3 7)
      (fast-mult 5 9)
      (fast-mult 19 111)
      (fast-mult 111 19))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline16" class="outline-4">
<h4 id="orgheadline16">exercise 1.19</h4>
<div class="outline-text-4" id="text-orgheadline16">
<p>
q &lt;- q<sup>2</sup><sup>nil</sup> + 2pq<br  />
p &lt;- p<sup>2</sup> + q<sup>2</sup><br  />
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">even?</span> n)
  (= (remainder n 2) 0))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">fib-iter</span> a b p q count)
  (<span style="color: #99cc99;">cond</span> ((= count 0) b)
        ((even? count) (fib-iter a
                             b
                             (+ (* p p) (* q q))
                             (+ (* 2 p q) (* q q))
                             (/ count 2)))
        (<span style="color: #99cc99;">else</span> (fib-iter (+ (* b q) (* a (+ p q)))
                        (+ (* b p) (* a q))
                        p
                        q
                        (- count 1)))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">fib</span> n)
  (fib-iter 1 0 0 1 n))

(list (fib 1)
      (fib 2)
      (fib 3)
      (fib 4)
      (fib 5)
      (fib 6)
      (fib 7))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline17" class="outline-4">
<h4 id="orgheadline17">Exercise 1.20</h4>
<div class="outline-text-4" id="text-orgheadline17">
<p>
正则序:<br  />
</p>
<div class="org-src-container">

<pre class="src src-scheme">(list (gcd 206 40)
      (gcd 40 (remainder 206 40))
      (gcd (remainder 206 40) (remainder 40 (remainder 206 40)))
      (gcd (remainder 40 (remainder 206 40))
           (remainder (remainder 206 40) (remainder 40 (remainder 206 40))))
      (gcd (remainder (remainder 206 40) (remainder 40 (remainder 206 40)))
           (remainder (remainder 40 (remainder 206 40))
            (remainder (remainder 206 40) (remainder 40 (remainder 206 40)))))
      (remainder (remainder 206 40) (remainder 40 (remainder 206 40))))
</pre>
</div>

<p>
IF: 0 + 1 + 2 + 4 + 7<br  />
GCD: 4<br  />
SUM: 18<br  />
</p>

<p>
应用序:<br  />
</p>
<div class="org-src-container">

<pre class="src src-scheme">(list (gcd 206 40)
      (gcd 40 6)
      (gcd 6 4)
      (gcd 4 2)
      (gcd 2 0))
</pre>
</div>

<p>
IF: 0<br  />
GCD: 4<br  />
SUM: 4<br  />
</p>
</div>
</div>

<div id="outline-container-orgheadline18" class="outline-4">
<h4 id="orgheadline18">Exercise 1.21</h4>
<div class="outline-text-4" id="text-orgheadline18">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">square</span> n)
  (* n n))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">smallest-divisor</span> n)
  (find-divisor n 2))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">find-divisor</span> n test-divisor)
  (<span style="color: #99cc99;">cond</span> ((&gt; (square test-divisor) n) n)
        ((divides? test-divisor n) test-divisor)
        (<span style="color: #99cc99;">else</span> (find-divisor n (+ test-divisor 1)))))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">divides?</span> a n)
  (= (remainder n a) 0))

(list (smallest-divisor 199)
      (smallest-divisor 1999)
      (smallest-divisor 19999))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline19" class="outline-4">
<h4 id="orgheadline19">Exercise 1.22</h4>
<div class="outline-text-4" id="text-orgheadline19">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">my-return</span>)
  (display <span style="color: #66cccc;">"loading ..."</span>)
  5)

(<span style="color: #99cc99;">define</span> <span style="color: #f99157;">lazy</span> (my-return))

(list lazy
      lazy
      lazy)
</pre>
</div>


<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">time-prime-test</span> n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">start-prime-test</span> n start-time)
  (<span style="color: #99cc99;">if</span> prime?
      (report-prime (- (runtime) start-time)))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">report-prime</span> elapsed-time)
  (display <span style="color: #66cccc;">" *** "</span>)
  (display elapsed-time))

(<span style="color: #99cc99;">define</span> (<span style="color: #f99157;">search-for-primes</span> i n)
  (<span style="color: #99cc99;">cond</span> ()
        ()
        (<span style="color: #99cc99;">else</span>))) <span style="color: #999999; font-style: italic;">;</span><span style="color: #999999; font-style: italic;">return the smallest i primes greater than n</span>
</pre>
</div>
</div>
</div>
</div>
</div>
